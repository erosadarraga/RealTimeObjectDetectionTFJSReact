{"ast":null,"code":"import _regeneratorRuntime from\"/home/eros/Escritorio/next IA/prueba final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/eros/Escritorio/next IA/prueba final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/eros/Escritorio/next IA/prueba final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// Import dependencies\nimport React,{useRef,useState,useEffect}from\"react\";import*as tf from\"@tensorflow/tfjs\";import*as cocossd from\"@tensorflow-models/coco-ssd\";import Webcam from\"react-webcam\";import\"../../App.css\";import{drawRect}from\"../../utilities\";import Socket from\"../../Socket\";export var Canva=function Canva(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),imgstate=_useState2[0],setImgstate=_useState2[1];var webcamRef=useRef(null);var canvasRef=useRef(null);// Main function\nvar runCoco=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var net;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return cocossd.load();case 2:net=_context.sent;console.log(\"Handpose model loaded.\");//  Loop and detect hands\nsetInterval(function(){detect(net);},500);case 5:case\"end\":return _context.stop();}}},_callee);}));return function runCoco(){return _ref.apply(this,arguments);};}();var detect=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(net){var video,videoWidth,videoHeight,obj,ctx,imgdata;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(typeof webcamRef.current!==\"undefined\"&&webcamRef.current!==null&&webcamRef.current.video.readyState===4)){_context2.next=17;break;}// Get Video Properties\nvideo=webcamRef.current.video;videoWidth=webcamRef.current.video.videoWidth;videoHeight=webcamRef.current.video.videoHeight;// Set video width\nwebcamRef.current.video.width=videoWidth;webcamRef.current.video.height=videoHeight;// Set canvas height and width\ncanvasRef.current.width=videoWidth;canvasRef.current.height=videoHeight;// Make Detections\n_context2.next=10;return net.detect(video);case 10:obj=_context2.sent;// Draw mesh\nctx=canvasRef.current.getContext(\"2d\");drawRect(obj,ctx);imgdata=webcamRef.current.getScreenshot();Socket.emit('stream',imgdata);setImgstate(imgdata);console.log(imgstate);case 17:case\"end\":return _context2.stop();}}},_callee2);}));return function detect(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){runCoco();},[]);return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",null,\"servidor\")),/*#__PURE__*/React.createElement(Webcam,{ref:webcamRef,muted:true,style:{position:\"absolute\",marginLeft:\"auto\",marginRight:\"auto\",left:0,right:0,textAlign:\"center\",zindex:9,width:640,height:480}}),/*#__PURE__*/React.createElement(\"canvas\",{ref:canvasRef,style:{position:\"absolute\",marginLeft:\"auto\",marginRight:\"auto\",left:0,right:0,textAlign:\"center\",zindex:8,width:640,height:480}}));};","map":{"version":3,"sources":["/home/eros/Escritorio/next IA/prueba final/client/src/components/socket/Canva.js"],"names":["React","useRef","useState","useEffect","tf","cocossd","Webcam","drawRect","Socket","Canva","imgstate","setImgstate","webcamRef","canvasRef","runCoco","load","net","console","log","setInterval","detect","current","video","readyState","videoWidth","videoHeight","width","height","obj","ctx","getContext","imgdata","getScreenshot","emit","position","marginLeft","marginRight","left","right","textAlign","zindex"],"mappings":"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","sourcesContent":["// Import dependencies\nimport React, { useRef, useState, useEffect } from \"react\";\nimport * as tf from \"@tensorflow/tfjs\";\nimport * as cocossd from \"@tensorflow-models/coco-ssd\";\nimport Webcam from \"react-webcam\";\nimport \"../../App.css\";\nimport { drawRect } from \"../../utilities\";\nimport Socket from \"../../Socket\";\n\n\nexport const Canva = () => {\n    const [imgstate, setImgstate] = useState(\"\")\n    const webcamRef = useRef(null);\n    const canvasRef = useRef(null);\n\n\n\n\n\n    // Main function\n    const runCoco = async () => {\n        const net = await cocossd.load();\n        console.log(\"Handpose model loaded.\");\n\n        //  Loop and detect hands\n        setInterval(() => {\n            detect(net);\n        }, 500);\n    };\n\n    const detect = async (net) => {\n        // Check data is available\n        if (\n            typeof webcamRef.current !== \"undefined\" &&\n            webcamRef.current !== null &&\n            webcamRef.current.video.readyState === 4\n        ) {\n            // Get Video Properties\n            const video = webcamRef.current.video;\n\n            const videoWidth = webcamRef.current.video.videoWidth;\n            const videoHeight = webcamRef.current.video.videoHeight;\n\n            // Set video width\n            webcamRef.current.video.width = videoWidth;\n            webcamRef.current.video.height = videoHeight;\n\n            // Set canvas height and width\n            canvasRef.current.width = videoWidth;\n            canvasRef.current.height = videoHeight;\n\n            // Make Detections\n            const obj = await net.detect(video);\n\n            // Draw mesh\n            const ctx = canvasRef.current.getContext(\"2d\");\n            drawRect(obj, ctx);\n            const imgdata = webcamRef.current.getScreenshot()\n            Socket.emit('stream', imgdata)\n            setImgstate(imgdata)\n\n            console.log(imgstate)\n        }\n    };\n\n    useEffect(() => { runCoco() }, []);\n\n    return (\n        <div className=\"App\">\n            <div><h1>servidor</h1></div>\n            <Webcam\n\n                ref={webcamRef}\n                muted={true}\n                style={{\n                    position: \"absolute\",\n                    marginLeft: \"auto\",\n                    marginRight: \"auto\",\n                    left: 0,\n                    right: 0,\n                    textAlign: \"center\",\n                    zindex: 9,\n                    width: 640,\n                    height: 480,\n                }}\n            />\n\n            <canvas\n\n                ref={canvasRef}\n                style={{\n                    position: \"absolute\",\n                    marginLeft: \"auto\",\n                    marginRight: \"auto\",\n                    left: 0,\n                    right: 0,\n                    textAlign: \"center\",\n                    zindex: 8,\n                    width: 640,\n                    height: 480,\n                }}\n            />\n\n        </div>\n    );\n}\n\n\n"]},"metadata":{},"sourceType":"module"}